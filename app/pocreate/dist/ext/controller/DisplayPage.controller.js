sap.ui.define(["sap/ui/core/mvc/ControllerExtension"],function(e){"use strict";return e.extend("pocreate.ext.controller.DisplayPage",{override:{onInit:function(){var e=this.base.getExtensionAPI().getModel()},onAfterItemAdded:function(e){var t=e.getParameter("item");this._createEntity(t).then(e=>{this._uploadContent(t,e)}).catch(e=>{console.log(e)})},onUploadCompleted:function(e){var t=this.byId("uploadSet");t.removeAllIncompleteItems();t.getBinding("items").refresh()},onOpenPressed:function(e){e.preventDefault();var t=e.getSource();_fileName=t.getFileName();this._download(t).then(e=>{var t=window.URL.createObjectURL(e);var n=document.createElement("a");n.href=t;n.setAttribute("download",this._fileName);document.body.appendChild(n);n.click();document.body.removeChild(n)}).catch(e=>{console.log(e)})},_createEntity:function(e){var t={mediaType:e.getMediaType(),fileName:e.getFileName(),size:e.getFileObject().size};var n={url:"/pocreation/Purchase_Attachment",method:"POST",headers:{"Content-type":"application/json"},data:JSON.stringify(t)};return new Promise((e,t)=>{$.ajax(n).done((t,n,o)=>{e(t.ID)}).fail(e=>{t(e)})})},_uploadContent:function(e,t){var n=`/pocreation/Purchase_Attachment(${t})/content`;e.setUploadUrl(n);var o=this.byId("uploadSet");o.setHttpRequestMethod("PUT");o.uploadItem(e)}}})});